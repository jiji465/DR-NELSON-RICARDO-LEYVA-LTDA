<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Relatório de Eficiência Tributária - Dr. Nelson Ricardo Leyva</title>
    
    <!-- Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    
    <!-- Tailwind CSS (CDN) -->
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    fontFamily: {
                        sans: ['Inter', 'sans-serif'],
                    },
                    colors: {
                        navy: '#1e3a8a',
                        gold: '#C5A059',
                    }
                },
            },
        }
    </script>

    <!-- Custom Print CSS -->
    <style>
        /* Base settings */
        body {
            -webkit-print-color-adjust: exact !important;
            print-color-adjust: exact !important;
        }

        /* Print Media Query */
        @media print {
            @page {
                margin: 0;
                size: A4 portrait;
            }
            
            html, body {
                background-color: white !important;
                margin: 0;
                padding: 0;
                font-size: 11px;
            }

            /* Page Structure */
            .print-page {
                height: 297mm;
                width: 210mm;
                padding: 15mm;
                position: relative;
                page-break-after: always;
                break-after: page;
                display: flex;
                flex-direction: column;
                justify-content: space-between;
                overflow: hidden;
            }

            .print-page:last-child {
                page-break-after: auto;
                break-after: auto;
            }

            /* Utilities */
            .no-print { display: none !important; }
            .print-only { display: block !important; }
            
            /* Grids */
            .print-grid-2 {
                display: grid !important;
                grid-template-columns: 1fr 1fr !important;
                gap: 2rem !important;
            }

            /* Component Overrides for Print */
            .shadow-xl, .shadow-2xl, .shadow-lg {
                box-shadow: none !important;
                border: 1px solid #e2e8f0 !important;
            }
            
            .bg-slate-50 { background-color: #fff !important; }
            
            /* Hide URL printing */
            a[href]:after { content: none !important; }
        }

        /* Screen only utilities */
        @media screen {
            .print-page {
                margin-bottom: 2rem;
                background: white;
                box-shadow: 0 4px 6px -1px rgb(0 0 0 / 0.1);
                border-radius: 1rem;
                padding: 2rem;
            }
            .print-only { display: none; }
        }
    </style>

    <!-- Import Map (Fixed: Removed conflicting React 19 versions) -->
    <script type="importmap">
{
  "imports": {
    "react": "https://esm.sh/react@18.2.0",
    "react-dom/client": "https://esm.sh/react-dom@18.2.0/client",
    "recharts": "https://esm.sh/recharts@2.12.2?deps=react@18.2.0,react-dom@18.2.0",
    "lucide-react": "https://esm.sh/lucide-react@0.344.0?deps=react@18.2.0,react-dom@18.2.0",
    "react-dom/": "https://esm.sh/react-dom@^19.2.4/",
    "react/": "https://esm.sh/react@^19.2.4/",
    "vite": "https://esm.sh/vite@^7.3.1",
    "@vitejs/plugin-react": "https://esm.sh/@vitejs/plugin-react@^5.1.4"
  }
}
</script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
</head>
<body class="bg-slate-100 min-h-screen text-slate-800 antialiased">
    <div id="root"></div>

    <script type="text/babel" data-type="module">
        import React from 'react';
        import { createRoot } from 'react-dom/client';
        import { 
            BarChart, Bar, XAxis, YAxis, CartesianGrid, Tooltip, ResponsiveContainer, Cell, LabelList,
            PieChart, Pie 
        } from 'recharts';
        import { 
            Calendar, Printer, ChevronRight, AlertCircle, CheckCircle2, 
            ArrowRight, ShieldCheck, FileCheck, Wallet, Calculator, BookOpen, User
        } from 'lucide-react';

        // --- DATA ---
        const COLORS = { NAVY: "#1e3a8a", GOLD: "#C5A059", SLATE_DARK: "#334155", SLATE_LIGHT: "#94a3b8" };

        const CLIENT_DATA = {
            clientName: "DR NELSON RICARDO LEYVA LTDA",
            competence: "01/2026",
            revenue: 16635.00
        };

        const COMPARISON_DATA = [
            { regime: "Simples Nacional", totalTax: 3101.60, effectiveRate: 18.65, color: COLORS.SLATE_LIGHT },
            { regime: "Lucro Presumido (SETE)", totalTax: 2697.86, effectiveRate: 16.22, color: COLORS.NAVY }
        ];

        const BREAKDOWN_DATA = [
            { name: "IRPJ/CSLL (Otimizados)", value: 819.38, color: COLORS.NAVY }, 
            { name: "PIS/COFINS", value: 607.18, color: "#64748b" },
            { name: "ISS (Municipal)", value: 831.75, color: COLORS.GOLD },  
            { name: "Encargos Folha", value: 439.55, color: COLORS.SLATE_DARK } 
        ];

        const BENEFIT_DATA = {
            withBenefitBase: 8485.00,
            withoutBenefitBase: 8150.00,
            totalBase: 16635.00,
            monthlySavings: 403.74
        };

        const TABLE_DATA = [
            { tax: "PIS/COFINS", base: "R$ 16.635,00", rate: "3,65%", value: 607.18 },
            { tax: "ISS (Municipal)", base: "R$ 16.635,00", rate: "5,00%", value: 831.75 },
            { tax: "IRPJ (Equiparado)", base: "R$ 1.330,80 (8%)", rate: "15,00%", value: 242.02 },
            { tax: "CSLL (Equiparado)", base: "R$ 1.996,20 (12%)", rate: "9,00%", value: 577.36 },
            { tax: "CPP (Folha)", base: "Salário Mín.", rate: "20,00%", value: 439.55 },
        ];

        const GLOSSARY = [
            { acronym: "IRPJ", full: "Imposto de Renda Pessoa Jurídica", desc: "Imposto federal sobre o lucro. Com a equiparação, reduzimos a base de 32% para 8%." },
            { acronym: "CSLL", full: "Contrib. Social s/ Lucro Líquido", desc: "Financia a seguridade social. Com a equiparação, reduzimos a base de 32% para 12%." },
            { acronym: "ISS", full: "Imposto Sobre Serviços", desc: "Imposto municipal fixo (Geralmente 5%) recolhido para a Prefeitura." },
            { acronym: "PIS/COFINS", full: "Programas de Integração Social", desc: "Contribuições federais. No Lucro Presumido, a alíquota combinada é 3,65%." },
            { acronym: "CPP", full: "Contrib. Previdenciária Patronal", desc: "Encargo sobre a folha de pagamento (Pró-labore/Salários)." }
        ];

        const formatCurrency = (val) => new Intl.NumberFormat('pt-BR', { style: 'currency', currency: 'BRL' }).format(val);

        // --- COMPONENTS ---

        const MainHeader = () => (
            <div className="bg-[#1e3a8a] text-white p-8 rounded-2xl shadow-lg relative overflow-hidden mb-8">
                <div className="flex justify-between items-end relative z-10">
                    <div>
                        <div className="flex items-center gap-3 mb-4 opacity-90">
                            <div className="h-[2px] w-8 bg-[#C5A059]"></div>
                            <span className="text-xs font-bold tracking-[0.2em] uppercase text-[#C5A059]">Demonstrativo Mensal</span>
                        </div>
                        <h1 className="text-3xl font-bold leading-tight mb-2 text-white">{CLIENT_DATA.clientName}</h1>
                        <p className="text-blue-100 font-light text-sm">Relatório de eficiência tributária e performance.</p>
                    </div>
                    <div className="text-right">
                        <p className="text-xs text-blue-200 uppercase tracking-widest font-semibold mb-1">Competência</p>
                        <p className="text-2xl font-bold text-white">{CLIENT_DATA.competence}</p>
                    </div>
                </div>
            </div>
        );

        const MiniHeader = ({ title }) => (
            <div className="flex justify-between items-center border-b-2 border-[#1e3a8a] pb-4 mb-8">
                <div>
                    <h2 className="text-xl font-bold text-[#1e3a8a] uppercase">{title}</h2>
                    <p className="text-xs text-slate-500 font-medium">{CLIENT_DATA.clientName} • {CLIENT_DATA.competence}</p>
                </div>
                <div className="text-[#C5A059]">
                    <FileCheck className="w-6 h-6" />
                </div>
            </div>
        );

        const PageFooter = ({ pageNum }) => (
            <div className="mt-auto pt-6 border-t border-slate-200 flex justify-between items-end text-[10px] text-slate-400">
                <div>
                    <strong className="text-[#1e3a8a] block mb-0.5">SETE Soluções Fiscais</strong>
                    <span>Documento confidencial</span>
                </div>
                <span>Página {pageNum} de 3</span>
            </div>
        );

        // --- PAGE 1 COMPONENTS ---
        const KpiSection = () => (
            <div className="grid grid-cols-1 gap-6 mb-8">
                 <div className="bg-white rounded-xl border border-slate-200 p-6 flex justify-between items-center shadow-sm">
                    <div>
                        <p className="text-xs text-slate-500 font-bold uppercase tracking-wider mb-1">Faturamento Apurado</p>
                        <p className="text-4xl font-bold text-[#1e3a8a]">{formatCurrency(CLIENT_DATA.revenue)}</p>
                    </div>
                    <div className="h-12 w-12 bg-blue-50 rounded-full flex items-center justify-center text-[#1e3a8a]">
                        <FileCheck className="w-6 h-6" />
                    </div>
                </div>
                
                <div className="bg-[#1e3a8a] text-white rounded-xl border border-blue-900 p-8 flex justify-between items-center shadow-md relative overflow-hidden">
                    <div className="relative z-10">
                        <p className="text-blue-200 text-xs font-bold uppercase tracking-wider mb-2">Economia na Competência</p>
                        <p className="text-5xl font-bold text-white">{formatCurrency(BENEFIT_DATA.monthlySavings)}</p>
                        <p className="text-xs text-blue-200 mt-2">Valor preservado no caixa da empresa</p>
                    </div>
                    <div className="h-16 w-16 bg-white/10 rounded-full flex items-center justify-center text-[#C5A059] relative z-10">
                        <Wallet className="w-8 h-8" strokeWidth={1.5} />
                    </div>
                </div>
            </div>
        );

        const VerdictBox = () => (
            <div className="bg-slate-50 rounded-2xl p-8 border border-slate-200 mb-8 flex-grow">
                <div className="inline-flex items-center gap-2 text-[#C5A059] font-bold text-xs uppercase tracking-widest mb-6">
                    <CheckCircle2 className="w-4 h-4" />
                    Conclusão
                </div>
                <h3 className="text-2xl font-bold text-[#1e3a8a] mb-4">Eficiência Tributária Confirmada</h3>
                <p className="text-slate-600 leading-relaxed text-justify mb-6">
                    A apuração realizada nesta competência demonstra que o regime de <strong>Lucro Presumido</strong>, aliado à estratégia de <strong>Equiparação Hospitalar</strong>, continua sendo a opção mais econômica para a clínica.
                </p>
                <div className="bg-emerald-50 border border-emerald-100 p-4 rounded-lg flex gap-4 items-start">
                    <div className="mt-1 text-emerald-600"><ShieldCheck className="w-5 h-5"/></div>
                    <div>
                        <p className="text-sm font-bold text-emerald-800">Segurança Jurídica</p>
                        <p className="text-xs text-emerald-700 mt-1">Todos os cálculos seguem rigorosamente a legislação vigente e as normas da Receita Federal para serviços médicos.</p>
                    </div>
                </div>
            </div>
        );

        // --- PAGE 2 COMPONENTS ---
        const DetailedTable = () => (
            <div className="mb-8">
                 <div className="flex items-center gap-2 mb-4">
                    <Calculator className="w-5 h-5 text-[#C5A059]" />
                    <h3 className="text-lg font-bold text-[#1e3a8a]">Memória de Cálculo</h3>
                </div>
                <table className="w-full text-sm border-collapse">
                    <thead>
                        <tr className="bg-slate-100 text-slate-500 uppercase text-[10px] font-bold border-b border-slate-200">
                            <th className="py-3 px-2 text-left">Tributo</th>
                            <th className="py-3 px-2 text-left">Base de Cálculo</th>
                            <th className="py-3 px-2 text-center">Alíquota</th>
                            <th className="py-3 px-2 text-right">Valor</th>
                        </tr>
                    </thead>
                    <tbody className="divide-y divide-slate-100">
                        {TABLE_DATA.map((row, idx) => (
                            <tr key={idx}>
                                <td className="py-3 px-2 font-semibold text-[#1e3a8a]">{row.tax}</td>
                                <td className="py-3 px-2 text-slate-600">{row.base}</td>
                                <td className="py-3 px-2 text-center text-slate-500">{row.rate}</td>
                                <td className="py-3 px-2 text-right font-bold text-slate-700">{formatCurrency(row.value)}</td>
                            </tr>
                        ))}
                    </tbody>
                    <tfoot>
                        <tr className="border-t-2 border-slate-200 font-bold text-[#1e3a8a]">
                            <td colSpan={3} className="py-4 px-2 text-right uppercase text-xs">Total Apurado</td>
                            <td className="py-4 px-2 text-right text-base">{formatCurrency(2697.86)}</td>
                        </tr>
                    </tfoot>
                </table>
            </div>
        );

        const ChartGrid = () => (
            <div className="grid grid-cols-2 gap-8 h-64 print:h-56">
                <div>
                    <h4 className="text-sm font-bold text-slate-600 mb-4 text-center">Comparativo de Regimes</h4>
                    <ResponsiveContainer width="100%" height="100%">
                        <BarChart data={COMPARISON_DATA} margin={{top: 20, right: 30, left: 0, bottom: 0}}>
                            <CartesianGrid strokeDasharray="3 3" vertical={false} />
                            <XAxis dataKey="regime" hide />
                            <YAxis hide />
                            <Bar dataKey="totalTax" barSize={40} label={{ position: 'top', formatter: formatCurrency, fill: '#1e3a8a', fontSize: 10, fontWeight: 'bold' }}>
                                {COMPARISON_DATA.map((entry, index) => <Cell key={`cell-${index}`} fill={entry.color} />)}
                            </Bar>
                        </BarChart>
                    </ResponsiveContainer>
                    <div className="flex justify-center gap-4 mt-2">
                        {COMPARISON_DATA.map((entry, i) => (
                            <div key={i} className="flex items-center gap-1 text-[10px]">
                                <div className="w-2 h-2 rounded-full" style={{backgroundColor: entry.color}}></div>
                                <span className="text-slate-500 truncate max-w-[80px]">{entry.regime}</span>
                            </div>
                        ))}
                    </div>
                </div>
                <div>
                    <h4 className="text-sm font-bold text-slate-600 mb-4 text-center">Distribuição de Custos</h4>
                    <ResponsiveContainer width="100%" height="100%">
                        <PieChart>
                            <Pie 
                                data={BREAKDOWN_DATA} 
                                cx="50%" cy="50%" 
                                innerRadius={40} outerRadius={60} 
                                paddingAngle={2} dataKey="value" 
                                label={({percent}) => `${(percent * 100).toFixed(0)}%`}
                            >
                                {BREAKDOWN_DATA.map((entry, index) => <Cell key={`cell-${index}`} fill={entry.color} />)}
                            </Pie>
                        </PieChart>
                    </ResponsiveContainer>
                    <div className="grid grid-cols-1 gap-1 mt-2">
                        {BREAKDOWN_DATA.map((entry, i) => (
                            <div key={i} className="flex items-center justify-between text-[10px]">
                                <div className="flex items-center gap-1">
                                    <div className="w-2 h-2 rounded-full" style={{backgroundColor: entry.color}}></div>
                                    <span className="text-slate-500">{entry.name}</span>
                                </div>
                                <span className="font-semibold">{formatCurrency(entry.value)}</span>
                            </div>
                        ))}
                    </div>
                </div>
            </div>
        );

        // --- PAGE 3 COMPONENTS ---
        const StrategyExplanation = () => (
            <div className="bg-slate-50 p-8 rounded-2xl border border-slate-200 mb-8">
                 <div className="flex items-center gap-2 mb-6">
                    <ShieldCheck className="w-5 h-5 text-[#C5A059]" />
                    <h3 className="text-lg font-bold text-[#1e3a8a]">Entendendo a Equiparação</h3>
                </div>
                
                <div className="flex gap-8 items-center mb-8">
                    <div className="flex-1 opacity-60">
                        <p className="text-xs font-bold text-slate-500 uppercase mb-2">Cenário Padrão</p>
                        <div className="bg-slate-200 h-2 w-full rounded-full overflow-hidden">
                            <div className="bg-slate-400 w-[32%] h-full"></div>
                        </div>
                        <p className="text-[10px] text-slate-500 mt-1">Imposto sobre 32% do faturamento</p>
                    </div>
                    <ArrowRight className="text-[#C5A059]" />
                    <div className="flex-1">
                        <p className="text-xs font-bold text-[#1e3a8a] uppercase mb-2">Com Equiparação</p>
                        <div className="bg-slate-200 h-2 w-full rounded-full overflow-hidden">
                            <div className="bg-[#1e3a8a] w-[8%] h-full"></div>
                        </div>
                        <p className="text-[10px] text-[#1e3a8a] mt-1 font-bold">Imposto sobre 8% do faturamento</p>
                    </div>
                </div>

                <p className="text-sm text-slate-600 leading-relaxed text-justify">
                    A legislação permite que clínicas médicas sejam tributadas como hospitais para determinados serviços. Isso reduz drasticamente a base de cálculo do IRPJ (de 32% para 8%) e da CSLL (de 32% para 12%), gerando a economia observada neste mês.
                </p>
            </div>
        );

        const GlossaryGrid = () => (
            <div>
                 <div className="flex items-center gap-2 mb-4">
                    <BookOpen className="w-5 h-5 text-[#C5A059]" />
                    <h3 className="text-lg font-bold text-[#1e3a8a]">Glossário</h3>
                </div>
                <div className="grid grid-cols-1 gap-3">
                    {GLOSSARY.map((term) => (
                        <div key={term.acronym} className="border-b border-slate-100 pb-2 last:border-0">
                            <div className="flex justify-between items-baseline">
                                <span className="font-bold text-[#1e3a8a] text-sm">{term.acronym}</span>
                                <span className="text-[10px] text-slate-400 font-medium">{term.full}</span>
                            </div>
                            <p className="text-[10px] text-slate-500 mt-1 leading-normal">{term.desc}</p>
                        </div>
                    ))}
                </div>
            </div>
        );


        // --- MAIN APP ---
        const App = () => {
            const handlePrint = () => setTimeout(() => window.print(), 150);

            return (
                <div className="max-w-[210mm] mx-auto p-4 md:p-8">
                    
                    {/* Controls */}
                    <div className="flex justify-end no-print mb-8">
                        <button 
                            onClick={handlePrint}
                            className="bg-[#1e3a8a] text-white px-6 py-3 rounded-xl font-bold flex items-center gap-2 hover:bg-blue-900 transition shadow-lg"
                        >
                            <Printer size={20} />
                            IMPRIMIR RELATÓRIO
                        </button>
                    </div>

                    {/* --- FOLHA 1: CAPA E RESULTADOS --- */}
                    <div className="print-page">
                        <div>
                            <MainHeader />
                            <KpiSection />
                            <VerdictBox />
                        </div>
                        <PageFooter pageNum={1} />
                    </div>

                    {/* --- FOLHA 2: ANÁLISE ANALÍTICA --- */}
                    <div className="print-page">
                        <div>
                            <MiniHeader title="Análise Tributária Analítica" />
                            <DetailedTable />
                            <div className="mt-8">
                                <ChartGrid />
                            </div>
                        </div>
                        <PageFooter pageNum={2} />
                    </div>

                    {/* --- FOLHA 3: ESTRATÉGIA E EDUCAÇÃO --- */}
                    <div className="print-page">
                        <div>
                            <MiniHeader title="Estratégia & Conceitos" />
                            <StrategyExplanation />
                            <GlossaryGrid />
                        </div>
                        <PageFooter pageNum={3} />
                    </div>

                </div>
            );
        };

        const root = createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>
</html>