<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Relatório de Eficiência Tributária - Dr. Nelson Ricardo Leyva</title>
    
    <!-- Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    fontFamily: {
                        sans: ['Inter', 'sans-serif'],
                    },
                },
            },
        }
    </script>

    <!-- Custom CSS -->
    <style>
        body {
            -webkit-print-color-adjust: exact !important;
            print-color-adjust: exact !important;
        }
        @media print {
            @page { 
                margin: 0;
                size: A4 portrait; 
            }
            html, body {
                height: 100%;
                width: 210mm;
                background-color: white !important;
            }
            body {
                padding: 10mm; /* Internal padding instead of page margin for background colors */
            }
            
            /* Utility to hide elements in print */
            .no-print { display: none !important; }
            
            /* Force background graphics */
            * {
                -webkit-print-color-adjust: exact !important;
                print-color-adjust: exact !important;
            }

            /* Layout adjustments */
            .print-grid-2 {
                display: grid !important;
                grid-template-columns: 1fr 1fr !important;
                gap: 1.5rem !important;
            }
            
            .print-full-width {
                width: 100% !important;
                max-width: none !important;
            }

            /* Header Fixes */
            header {
                padding-top: 1rem !important;
                padding-bottom: 2rem !important;
                background-color: #1e3a8a !important; /* Ensure Navy background prints */
                color: white !important;
                border-radius: 1rem !important;
                margin-bottom: 1.5rem !important;
            }
            header .absolute { display: none !important; } /* Hide blurs */

            /* Chart Fixes */
            .recharts-wrapper { width: 100% !important; }
            
            /* Avoid breaks */
            .break-inside-avoid {
                break-inside: avoid;
                page-break-inside: avoid;
            }
        }
    </style>

    <!-- Import Map -->
    <script type="importmap">
{
  "imports": {
    "react": "https://esm.sh/react@18.2.0",
    "react-dom/client": "https://esm.sh/react-dom@18.2.0/client",
    "recharts": "https://esm.sh/recharts@2.12.2?external=react,react-dom",
    "lucide-react": "https://esm.sh/lucide-react@0.344.0?external=react,react-dom",
    "react-dom/": "https://esm.sh/react-dom@^19.2.4/",
    "react/": "https://esm.sh/react@^19.2.4/",
    "vite": "https://esm.sh/vite@^7.3.1",
    "@vitejs/plugin-react": "https://esm.sh/@vitejs/plugin-react@^5.1.4"
  }
}
</script>

    <!-- Babel -->
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
</head>
<body class="text-slate-800 antialiased bg-slate-50 min-h-screen">
    <div id="root"></div>

    <script type="text/babel" data-type="module">
        import React from 'react';
        import { createRoot } from 'react-dom/client';
        import { 
            BarChart, Bar, XAxis, YAxis, CartesianGrid, Tooltip as RechartsTooltip, ResponsiveContainer, Cell, LabelList,
            PieChart, Pie 
        } from 'recharts';
        import { 
            Calendar, Printer, ChevronRight, AlertCircle, CheckCircle2, 
            ArrowRight, ShieldCheck, FileCheck, Wallet, TrendingUp 
        } from 'lucide-react';

        // --- DATA ---
        const CLIENT_DATA = {
            clientName: "DR NELSON RICARDO LEYVA LTDA",
            competence: "01/2026",
            revenue: 16635.00
        };

        const COMPARISON_DATA = [
            { regime: "Simples Nacional", totalTax: 3101.60, effectiveRate: 18.65, color: "#94a3b8" },
            { regime: "Lucro Presumido (SETE)", totalTax: 2697.86, effectiveRate: 16.22, color: "#1e3a8a" }
        ];

        const BREAKDOWN_DATA = [
            { name: "Impostos Federais", value: 1426.56, color: "#1e3a8a" }, 
            { name: "ISS (Municipal)", value: 831.75, color: "#C5A059" },  
            { name: "Encargos Folha", value: 439.55, color: "#334155" } 
        ];

        const BENEFIT_DATA = {
            withBenefitBase: 8485.00,
            withoutBenefitBase: 8150.00,
            resultingTax: 819.38, 
            monthlySavings: 403.74,
            annualSavings: 4844.88
        };

        const formatCurrency = (val) => new Intl.NumberFormat('pt-BR', { style: 'currency', currency: 'BRL' }).format(val);

        // --- COMPONENTS ---

        const Header = () => (
            <header className="bg-[#1e3a8a] text-white pt-12 pb-16 px-8 rounded-b-3xl md:rounded-3xl shadow-xl relative overflow-hidden print:rounded-xl">
                {/* Decorative blobs - Hidden in print */}
                <div className="absolute top-0 right-0 w-[500px] h-[500px] bg-[#C5A059] opacity-15 rounded-full blur-[100px] pointer-events-none no-print"></div>
                
                <div className="flex flex-col md:flex-row justify-between items-start md:items-end gap-6 relative z-10">
                    <div>
                        <div className="flex items-center gap-3 mb-4 opacity-90">
                            <div className="h-[2px] w-8 bg-[#C5A059]"></div>
                            <span className="text-xs font-bold tracking-[0.2em] uppercase text-[#C5A059]">Relatório Mensal</span>
                        </div>
                        <h1 className="text-2xl md:text-4xl font-bold leading-tight mb-2 tracking-tight text-white">
                            {CLIENT_DATA.clientName}
                        </h1>
                        <p className="text-blue-100 font-light text-sm md:text-base">
                            Análise de Eficiência Tributária
                        </p>
                    </div>
                    
                    <div className="bg-white/10 px-5 py-3 rounded-lg border border-white/10 print:bg-[#1e3a8a] print:border-white/30">
                        <div className="flex items-center gap-3">
                            <Calendar className="w-5 h-5 text-[#C5A059]" />
                            <div>
                                <p className="text-[10px] text-blue-200 uppercase tracking-widest font-semibold">Competência</p>
                                <p className="text-xl font-bold text-white">{CLIENT_DATA.competence}</p>
                            </div>
                        </div>
                    </div>
                </div>
            </header>
        );

        const KPICards = () => (
            <div className="grid grid-cols-1 md:grid-cols-2 gap-6 print:gap-6 print-grid-2">
                {/* Card 1: Faturamento */}
                <div className="bg-white p-6 rounded-2xl shadow-sm border border-slate-100 flex items-center justify-between">
                    <div>
                        <p className="text-xs text-slate-500 font-bold uppercase tracking-wider mb-1">Faturamento Apurado</p>
                        <p className="text-3xl font-bold text-[#1e3a8a]">{formatCurrency(CLIENT_DATA.revenue)}</p>
                    </div>
                    <div className="p-3 bg-blue-50 text-[#1e3a8a] rounded-full">
                        <FileCheck className="w-6 h-6" />
                    </div>
                </div>

                {/* Card 2: Economia (Moved here for Print Alignment) */}
                <div className="bg-[#1e3a8a] p-6 rounded-2xl shadow-md border border-blue-900 flex items-center justify-between text-white print:bg-[#1e3a8a]">
                    <div>
                        <p className="text-xs text-blue-200 font-bold uppercase tracking-wider mb-1">Economia Mensal</p>
                        <p className="text-3xl font-bold text-white">{formatCurrency(BENEFIT_DATA.monthlySavings)}</p>
                    </div>
                    <div className="p-3 bg-white/10 text-[#C5A059] rounded-full">
                        <Wallet className="w-6 h-6" />
                    </div>
                </div>
            </div>
        );

        const ChartsSection = () => (
            <div className="grid grid-cols-1 md:grid-cols-2 gap-6 print:gap-6 print-grid-2 items-stretch">
                {/* Comparison Chart */}
                <div className="bg-white p-6 rounded-2xl shadow-sm border border-slate-100 flex flex-col h-full">
                    <h3 className="text-lg font-bold text-[#1e3a8a] mb-4">Comparativo de Carga</h3>
                    <div className="h-48 w-full flex-grow">
                        <ResponsiveContainer width="100%" height="100%">
                            <BarChart data={COMPARISON_DATA} layout="vertical" margin={{top:0, right:50, bottom:0, left:0}}>
                                <XAxis type="number" hide />
                                <YAxis dataKey="regime" type="category" width={10} tick={false} axisLine={false} />
                                <Bar dataKey="totalTax" radius={[0, 4, 4, 0]} barSize={32}>
                                    {COMPARISON_DATA.map((e, i) => <Cell key={i} fill={e.color} />)}
                                    <LabelList dataKey="totalTax" position="right" formatter={formatCurrency} style={{fill:'#1e3a8a', fontSize:'11px', fontWeight:'bold'}} />
                                </Bar>
                            </BarChart>
                        </ResponsiveContainer>
                    </div>
                    <div className="mt-4 space-y-2">
                         {COMPARISON_DATA.map((d, i) => (
                             <div key={i} className="flex justify-between items-center text-xs">
                                 <div className="flex items-center gap-2">
                                     <div className={`w-2 h-2 rounded-full`} style={{backgroundColor: d.color}}></div>
                                     <span className="text-slate-600 font-medium">{d.regime}</span>
                                 </div>
                                 <span className="font-bold text-slate-700">{d.effectiveRate}%</span>
                             </div>
                         ))}
                    </div>
                </div>

                {/* Breakdown Chart */}
                <div className="bg-white p-6 rounded-2xl shadow-sm border border-slate-100 flex flex-col h-full">
                    <h3 className="text-lg font-bold text-[#1e3a8a] mb-4">Composição (Presumido)</h3>
                    <div className="h-48 w-full flex-grow relative">
                        <ResponsiveContainer width="100%" height="100%">
                            <PieChart>
                                <Pie 
                                    data={BREAKDOWN_DATA} cx="50%" cy="50%" innerRadius={60} outerRadius={80} 
                                    dataKey="value" stroke="none" paddingAngle={2}
                                >
                                    {BREAKDOWN_DATA.map((e, i) => <Cell key={i} fill={e.color} />)}
                                </Pie>
                            </PieChart>
                        </ResponsiveContainer>
                        <div className="absolute inset-0 flex items-center justify-center pointer-events-none">
                            <span className="text-sm font-bold text-[#1e3a8a]">{formatCurrency(COMPARISON_DATA[1].totalTax)}</span>
                        </div>
                    </div>
                    <div className="mt-4 space-y-2">
                        {BREAKDOWN_DATA.map((d, i) => (
                            <div key={i} className="flex justify-between items-center text-xs border-b border-slate-50 last:border-0 pb-1 last:pb-0">
                                <span className="text-slate-500">{d.name}</span>
                                <span className="font-bold text-slate-700">{formatCurrency(d.value)}</span>
                            </div>
                        ))}
                    </div>
                </div>
            </div>
        );

        const StrategySection = () => (
            <div className="bg-white p-6 rounded-2xl shadow-sm border border-slate-100 flex flex-col md:flex-row gap-8 items-center print:break-inside-avoid">
                <div className="md:w-1/2">
                    <div className="inline-block px-3 py-1 bg-blue-50 text-[#1e3a8a] text-[10px] font-bold uppercase tracking-widest rounded-full mb-3">
                        Estratégia
                    </div>
                    <h3 className="text-xl font-bold text-[#1e3a8a] mb-3">Equiparação Hospitalar</h3>
                    <p className="text-sm text-slate-600 leading-relaxed">
                        A aplicação da Equiparação Hospitalar reduziu drasticamente a base de cálculo de IRPJ e CSLL (de 32% para 8%/12%) sobre os serviços elegíveis.
                    </p>
                </div>
                <div className="md:w-1/2 w-full bg-slate-50 p-4 rounded-xl border border-slate-200">
                    <div className="flex justify-between items-center mb-2">
                        <span className="text-xs text-slate-500">Sem Benefício</span>
                        <span className="text-xs font-bold text-slate-400 line-through">{formatCurrency(BENEFIT_DATA.withoutBenefitBase)}</span>
                    </div>
                    <div className="h-2 w-full bg-slate-200 rounded-full mb-4 overflow-hidden">
                         <div className="h-full bg-slate-400 w-full opacity-30"></div>
                    </div>
                    
                    <div className="flex justify-between items-center mb-2">
                        <span className="text-xs font-bold text-[#1e3a8a]">Com Benefício</span>
                        <span className="text-sm font-bold text-[#1e3a8a]">{formatCurrency(BENEFIT_DATA.withBenefitBase)}</span>
                    </div>
                    <div className="h-3 w-full bg-blue-100 rounded-full overflow-hidden">
                         <div className="h-full bg-[#1e3a8a] w-[30%]"></div>
                    </div>
                </div>
            </div>
        );

        const FinalVerdict = () => (
            <div className="bg-emerald-50 border border-emerald-100 p-6 rounded-2xl flex items-center justify-between print:break-inside-avoid">
                 <div className="flex items-center gap-4">
                     <div className="bg-white p-3 rounded-full shadow-sm text-emerald-600">
                         <TrendingUp className="w-6 h-6" />
                     </div>
                     <div>
                         <p className="text-xs font-bold text-emerald-600 uppercase tracking-wider">Projeção Anual</p>
                         <p className="text-emerald-800 text-sm">Economia acumulada estimada em 12 meses</p>
                     </div>
                 </div>
                 <div className="text-right">
                     <p className="text-2xl font-bold text-emerald-700">{formatCurrency(BENEFIT_DATA.annualSavings)}</p>
                 </div>
            </div>
        );

        const App = () => {
            const handlePrint = () => setTimeout(() => window.print(), 100);

            return (
                <div className="max-w-4xl mx-auto p-4 md:p-8 space-y-6 print:space-y-6 print:p-0">
                    <Header />
                    
                    <div className="flex justify-end no-print">
                        <button onClick={handlePrint} className="bg-[#1e3a8a] text-white px-6 py-2 rounded-lg font-semibold text-sm flex items-center gap-2 hover:bg-blue-900 transition-colors shadow-lg">
                            <Printer className="w-4 h-4" />
                            Imprimir PDF
                        </button>
                    </div>

                    {/* Metrics Row: Faturamento & Economia side by side */}
                    <KPICards />
                    
                    {/* Charts Row */}
                    <ChartsSection />
                    
                    {/* Info Section */}
                    <StrategySection />
                    
                    {/* Final Verdict */}
                    <FinalVerdict />

                    <footer className="text-center pt-8 border-t border-slate-100 text-slate-400 text-xs print:pt-4">
                        SETE Soluções Fiscais • Documento Confidencial
                    </footer>
                </div>
            );
        };

        const root = createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>
</html>